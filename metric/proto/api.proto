syntax = "proto3";

package api;

option go_package = "/api";

import "google/protobuf/timestamp.proto";
import "google/protobuf/duration.proto";

message TaskStartInfo {
    reserved 1;
    string metric = 2;
    google.protobuf.Timestamp updated_at = 3;
    google.protobuf.Duration update_rate = 4;
    int32 weight = 5;
    repeated string data = 6;
    repeated string groups = 7;
}

message TaskInfo {
    string id = 1;
    string metric = 2;
    google.protobuf.Timestamp updated_at = 3;
    google.protobuf.Duration update_rate = 4;
    int32 weight = 5;
    repeated string data = 6;
    repeated string groups = 7;
}

message SnapshotInfo {
    string Metric = 1;
    string Data = 2;
    repeated string Groups = 3;
}

message TaskStartRequest {
    TaskStartInfo task = 1;
}

message TaskStartResponse {
    TaskInfo task = 1;
}

message TaskStopRequest {
    string id = 1;
}

message TaskStopResponse {
    TaskInfo task = 1;
}

message TaskListRequest {

}

message TaskListResponse {
    repeated TaskInfo tasks = 1;
}

message SnapshotListRequest {
    string Group = 1;
}

message SnapshotListResult {
    repeated SnapshotInfo Snapshots = 1;
}

service TaskService {
    rpc Start(TaskStartRequest) returns (TaskStartResponse);
    rpc Stop(TaskStopRequest) returns (TaskStopResponse);
    rpc List(TaskListRequest) returns(TaskListResponse);
    rpc SnapshotList(SnapshotListRequest) returns (SnapshotListResult);
}